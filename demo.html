<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google Maps Directions API</title>
  <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBAtsxaRQmakZQsAOUPNx4N_Fh9m3IiqAg&libraries=places"></script>
</head>
<body>
  <div id="map" style="height: 400px;"></div>

  <script>
    const directionsService = new google.maps.DirectionsService();
    const directionsRenderer = new google.maps.DirectionsRenderer();
    
    const map = new google.maps.Map(document.getElementById('map'), {
      zoom: 8,
      center: { lat: 35.638591, lng: 139.746087 }, // 港区立芝浦を中心に地図を表示
    });

    directionsRenderer.setMap(map);

    const locations = [
      { lat: 35.638591, lng: 139.746087 }, // 港区立芝浦
      { lat: 35.645012, lng: 139.728899 }, // 港区立三光
      { lat: 35.661488, lng: 139.738892 }, // 港区立麻布
      { lat: 35.657219, lng: 139.730392 }, // 港区立南山
      { lat: 35.666023, lng: 139.732208 }, // 港区立中之町
    ];

    function calculateAndDisplayRoute() {
      const waypoints = locations.map(location => ({ location }));

      directionsService.route(
        {
          origin: locations[0],
          destination: locations[4],
          waypoints: waypoints,
          optimizeWaypoints: true,
          travelMode: 'DRIVING',
        },
        (response, status) => {
          if (status === 'OK') {
            directionsRenderer.setDirections(response);
          } else {
            window.alert( status + ' が原因でルート検索に失敗しました。');
          }
        }
      );
    }

    calculateAndDisplayRoute();
  </script>
</body>
</html>
